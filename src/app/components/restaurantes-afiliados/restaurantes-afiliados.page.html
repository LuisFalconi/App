<ion-header>
  <ion-toolbar>
    <ion-button slot="start" fill="none" (click)="goMapa()">
      <ion-icon name="arrow-back"></ion-icon>
    </ion-button>
    <ion-button slot="end" fill ="none" (click)="presentActionSheet()">
      <ion-icon name = "menu" ></ion-icon>
    </ion-button>
    <ion-title>Restaurantes Afiliados</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>

  <ion-card>
    <div *ngFor="let a of afiliados$ | async">
      <div *ngFor="let r of restaurante$ | async">
        <div *ngIf="usuarioLog === a.uidUsu && r.userUID === a.uidResta">
          <div class="titulo">
            <h2 style="text-align: center;">{{r.nombreRestaurante}}</h2>
          </div>
          <img [src]="r.imagenRes" *ngIf="r.imagenRes">
          <div *ngIf="a.estado ==='verdadero'"> 
            <form [formGroup] ="calificar" (ngSubmit) = "presentAlertConfirm(r.id)" style="text-align: center;">
              <p class="clasificacion">
                <input id="radio1" type="radio" formControlName="estrellas" value="5"><!--
                --><label for="radio1">★</label><!--
                --><input id="radio2" type="radio" formControlName="estrellas" value="4"><!--
                --><label for="radio2">★</label><!--
                --><input id="radio3" type="radio" formControlName="estrellas" value="3"><!--
                --><label for="radio3">★</label><!--
                --><input id="radio4" type="radio" formControlName="estrellas" value="2"><!--
                --><label for="radio4">★</label><!--
                --><input id="radio5" type="radio" formControlName="estrellas" value="1"><!--
                --><label for="radio5">★</label>
              </p>
              <ion-button [disabled] ="calificar.invalid" type = "submit" expand = "block" id="este">
                <p>Calificar</p> 
              </ion-button>
            </form>
            <form [formGroup] ="comentar" (ngSubmit) = "Comentar(r.userUID)" style="text-align: center;">
              <ion-item>
                <ion-input class="texto" placeholder="Realizar Comentario" formControlName="comentario" type="text"  maxlength ="40"></ion-input>
              </ion-item>
              <div >
                <ng-container *ngFor ="let error of errorMensajes.comentario">
                  <div class="e" *ngIf ="comentar.get('comentario').hasError(error.type) && (comentar.get('comentario').dirty || comentar.get('comentario').touched)">
                    {{error.message}}
                  </div>
                </ng-container> 
              </div> 
              <ion-button [disabled] ="comentar.invalid" type = "submit" expand = "block" id="este">
                <p>Comentar</p> 
              </ion-button>
            </form>
          </div>
        
          <ion-button *ngIf="a.estado ==='falso'" color="danger">Pendiente</ion-button>
          <!-- <ion-button color="danger" (click)="presentAlertConfirm()">aa</ion-button> -->
          <ion-button *ngIf="a.estado ==='verdadero'" color="danger" (click) ="presentModal(r.userUID)">Realizar Reserva</ion-button>


        </div>
      </div>
    </div>
  </ion-card>

</ion-content>
